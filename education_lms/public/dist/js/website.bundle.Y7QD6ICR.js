(()=>{frappe.ready(()=>{Ut()});var Ut=()=>{if(frappe.session.user=="Guest"){let e=$(".nav-link").filter((i,a)=>$(a).text().trim()==="My Profile"||$(a).text().trim()==="Dashboard");e.length&&e.each((i,a)=>$(a).addClass("hide"))}};frappe.ready(()=>{Gt(),$(".join-batch").click(e=>{Xt(e)}),$(".notify-me").click(e=>{Jt(e)}),$(".btn-chapter").click(e=>{Kt(e)}),$(document).on("click",".btn-save-chapter",e=>{Qt(e)}),$(".nav-link").click(e=>{te(e)}),window.location.hash&&ee(),window.location.pathname=="/statistics"&&(Q("New Signups","#new-signups"),Q("Course Enrollments","#course-enrollments"),Q("Lesson Completion","#lesson-completion"),Zt())});var Gt=()=>{frappe.provide("frappe.form.formatters"),frappe.form.formatters.FileSize=qt},qt=e=>(e>1048576?e=flt(flt(e)/1048576,1)+"M":e>1024&&(e=flt(flt(e)/1024,1)+"K"),e),Xt=e=>{e.preventDefault();let i=$(e.currentTarget).attr("data-course");if(frappe.session.user=="Guest"){window.location.href=`/login?redirect-to=/courses/${i}`;return}let a=$(e.currentTarget).attr("data-batch");a=a?decodeURIComponent(a):"",frappe.call({method:"lms.lms.doctype.lms_batch_membership.lms_batch_membership.create_membership",args:{batch:a||"",course:i},callback:t=>{t.message=="OK"&&($(".no-preview-modal").modal("hide"),frappe.show_alert({message:__("Enrolled successfully"),indicator:"green"},3),setTimeout(function(){window.location.href=`/courses/${i}/learn/1.1`},1e3))}})},Jt=e=>{e.preventDefault();var i=decodeURIComponent($(e.currentTarget).attr("data-course"));if(frappe.session.user=="Guest"){window.location.href=`/login?redirect-to=/courses/${i}`;return}frappe.call({method:"lms.lms.doctype.lms_course_interest.lms_course_interest.capture_interest",args:{course:i},callback:a=>{$(".no-preview-modal").modal("hide"),frappe.show_alert({message:__("You have opted to be notified for this course. You will receive an email when the course becomes available."),indicator:"green"},3),setTimeout(()=>{window.location.reload()},3e3)}})},Kt=e=>{if($(".new-chapter").length){pt();return}let i=$("[data-index]").last().data("index")+1||1,a=$(".chapter-parent:last").length?$(".chapter-parent:last"):$("#outline-heading");$(`<div class="chapter-parent chapter-edit new-chapter">
        <div contenteditable="true" data-placeholder="${__("Chapter Name")}" class="chapter-title-main"></div>
        <div class="chapter-description small my-2" contenteditable="true"
            data-placeholder="${__("Short Description")}"></div>
        <button class="btn btn-sm btn-secondary d-block btn-save-chapter"
        data-index="${i}"> ${__("Save")} </button>
        </div>`).insertAfter(a),pt()},pt=()=>{$([document.documentElement,document.body]).animate({scrollTop:$(".new-chapter").offset().top},1e3),$(".new-chapter").find(".chapter-title-main").focus()},Qt=e=>{let i=$(e.currentTarget),a=i.closest(".chapter-parent");frappe.call({method:"lms.lms.doctype.lms_course.lms_course.save_chapter",args:{course:$("#title").data("course"),title:a.find(".chapter-title-main").text(),chapter_description:a.find(".chapter-description").text(),idx:i.data("index"),chapter:i.data("chapter")?i.data("chapter"):""},callback:t=>{frappe.show_alert({message:__("Saved"),indicator:"green"}),setTimeout(()=>{window.location.reload()},1e3)}})},Q=(e,i,a="line")=>{let t=frappe.datetime;frappe.call({method:"lms.lms.utils.get_chart_data",args:{chart_name:e,timespan:"Select Date Range",timegrain:"Daily",from_date:t.add_days(t.get_today(),-30),to_date:t.add_days(t.get_today(),1)},callback:n=>{ft(n.message,e,i,a)}})},ft=(e,i,a,t)=>{let n=new frappe.Chart(a,{title:i,data:e,type:t,height:250,colors:["#4563f1"],axisOptions:{xIsSeries:1},lineOptions:{regionFill:1}})},Zt=()=>{frappe.call({method:"lms.lms.utils.get_course_completion_data",callback:e=>{ft(e.message,"Course Completion","#course-completion","pie")}})},te=e=>{window.location.hash=$(e.currentTarget).attr("href")},ee=()=>{$(`a[href="${window.location.hash}"]`).click()};function J(e){return(J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(e)}function P(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function gt(e,i){for(var a=0;a<i.length;a++){var t=i[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function N(e,i,a){return i&&gt(e.prototype,i),a&&gt(e,a),e}function R(e,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),i&&Et(e,i)}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)})(e)}function Et(e,i){return(Et=Object.setPrototypeOf||function(a,t){return a.__proto__=t,a})(e,i)}function ne(e,i){return!i||typeof i!="object"&&typeof i!="function"?function(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}(e):i}function H(e){var i=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}();return function(){var a,t=w(e);if(i){var n=w(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return ne(this,a)}}function L(e,i,a){return(L=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(t,n,s){var r=function(l,c){for(;!Object.prototype.hasOwnProperty.call(l,c)&&(l=w(l))!==null;);return l}(t,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(s):o.value}})(e,i,a||e)}function k(e,i){return function(a){if(Array.isArray(a))return a}(e)||function(a,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(a)))){var n=[],s=!0,r=!1,o=void 0;try{for(var l,c=a[Symbol.iterator]();!(s=(l=c.next()).done)&&(n.push(l.value),!t||n.length!==t);s=!0);}catch(u){r=!0,o=u}finally{try{s||c.return==null||c.return()}finally{if(r)throw o}}return n}}(e,i)||Ot(e,i)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function T(e){return function(i){if(Array.isArray(i))return at(i)}(e)||function(i){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(i))return Array.from(i)}(e)||Ot(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ot(e,i){if(e){if(typeof e=="string")return at(e,i);var a=Object.prototype.toString.call(e).slice(8,-1);return a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set"?Array.from(e):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?at(e,i):void 0}}function at(e,i){(i==null||i>e.length)&&(i=e.length);for(var a=0,t=new Array(i);a<i;a++)t[a]=e[a];return t}function E(e,i){return typeof e=="string"?(i||document).querySelector(e):e||null}function q(e){var i=e.getBoundingClientRect();return{top:i.top+(document.documentElement.scrollTop||document.body.scrollTop),left:i.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}function ae(e){return e.offsetParent===null}function ie(e){var i=e.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)}(function(e,i){i===void 0&&(i={});var a=i.insertAt;if(e&&typeof document!="undefined"){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",a==="top"&&t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}})(`:root {
  --charts-label-color: #313b44;
  --charts-axis-line-color: #f4f5f6;
  --charts-tooltip-title: var(--charts-label-color);
  --charts-tooltip-label: var(--charts-label-color);
  --charts-tooltip-value: #192734;
  --charts-tooltip-bg: #ffffff;
  --charts-stroke-width: 2px;
  --charts-dataset-circle-stroke: #ffffff;
  --charts-dataset-circle-stroke-width: var(--charts-stroke-width);
  --charts-legend-label: var(--charts-label-color);
  --charts-legend-value: var(--charts-label-color); }

.chart-container {
  position: relative;
  /* for absolutely positioned tooltip */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif; }
  .chart-container .axis,
  .chart-container .chart-label {
    fill: var(--charts-label-color); }
    .chart-container .axis line,
    .chart-container .chart-label line {
      stroke: var(--charts-axis-line-color); }
  .chart-container .dataset-units circle {
    stroke: var(--charts-dataset-circle-stroke);
    stroke-width: var(--charts-dataset-circle-stroke-width); }
  .chart-container .dataset-units path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container .dataset-path {
    stroke-width: var(--charts-stroke-width); }
  .chart-container .path-group path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container line.dashed {
    stroke-dasharray: 5, 3; }
  .chart-container .axis-line .specific-value {
    text-anchor: start; }
  .chart-container .axis-line .y-line {
    text-anchor: end; }
  .chart-container .axis-line .x-line {
    text-anchor: middle; }
  .chart-container .legend-dataset-label {
    fill: var(--charts-legend-label);
    font-weight: 600; }
  .chart-container .legend-dataset-value {
    fill: var(--charts-legend-value); }

.graph-svg-tip {
  position: absolute;
  z-index: 99999;
  padding: 10px;
  font-size: 12px;
  text-align: center;
  background: var(--charts-tooltip-bg);
  box-shadow: 0px 1px 4px rgba(17, 43, 66, 0.1), 0px 2px 6px rgba(17, 43, 66, 0.08), 0px 40px 30px -30px rgba(17, 43, 66, 0.1);
  border-radius: 6px; }
  .graph-svg-tip ul {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ol {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ul.data-point-list li {
    min-width: 90px;
    font-weight: 600; }
  .graph-svg-tip .svg-pointer {
    position: absolute;
    height: 12px;
    width: 12px;
    border-radius: 2px;
    background: var(--charts-tooltip-bg);
    transform: rotate(45deg);
    margin-top: -7px;
    margin-left: -6px; }
  .graph-svg-tip.comparison {
    text-align: left;
    padding: 0px;
    pointer-events: none; }
    .graph-svg-tip.comparison .title {
      display: block;
      padding: 16px;
      margin: 0;
      color: var(--charts-tooltip-title);
      font-weight: 600;
      line-height: 1;
      pointer-events: none;
      text-transform: uppercase; }
      .graph-svg-tip.comparison .title strong {
        color: var(--charts-tooltip-value); }
    .graph-svg-tip.comparison ul {
      margin: 0;
      white-space: nowrap;
      list-style: none; }
      .graph-svg-tip.comparison ul.tooltip-grid {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 5px; }
    .graph-svg-tip.comparison li {
      display: inline-block;
      display: flex;
      flex-direction: row;
      font-weight: 600;
      line-height: 1;
      padding: 5px 15px 15px 15px; }
      .graph-svg-tip.comparison li .tooltip-legend {
        height: 12px;
        width: 12px;
        margin-right: 8px;
        border-radius: 2px; }
      .graph-svg-tip.comparison li .tooltip-label {
        margin-top: 4px;
        font-size: 11px;
        line-height: 1.25;
        max-width: 150px;
        white-space: normal;
        color: var(--charts-tooltip-label); }
      .graph-svg-tip.comparison li .tooltip-value {
        color: var(--charts-tooltip-value); }
`),E.create=function(e,i){var a=document.createElement(e);for(var t in i){var n=i[t];if(t==="inside")E(n).appendChild(a);else if(t==="around"){var s=E(n);s.parentNode.insertBefore(a,s),a.appendChild(s)}else t==="styles"?J(n)==="object"&&Object.keys(n).map(function(r){a.style[r]=n[r]}):t in a?a[t]=n:a.setAttribute(t,n)}return a};var se={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function X(e){return e.titleHeight+e.margins.top+e.paddings.top}function G(e){return e.margins.left+e.paddings.left}function ut(e){return e.margins.top+e.margins.bottom+e.paddings.top+e.paddings.bottom+e.titleHeight+e.legendHeight}function it(e){return e.margins.left+e.margins.right+e.paddings.left+e.paddings.right}var W=["pink","blue","green","grey","red","yellow","purple","teal","cyan","orange"],re={bar:W,line:W,pie:W,percentage:W,heatmap:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],donut:W},mt=Math.PI/180,oe=function(){function e(i){var a=i.parent,t=a===void 0?null:a,n=i.colors,s=n===void 0?[]:n;P(this,e),this.parent=t,this.colors=s,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}return N(e,[{key:"setup",value:function(){this.makeTooltip()}},{key:"refresh",value:function(){this.fill(),this.calcPosition()}},{key:"makeTooltip",value:function(){var i=this;this.container=E.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:`<span class="title"></span>
				<ul class="data-point-list"></ul>
				<div class="svg-pointer"></div>`}),this.hideTip(),this.title=this.container.querySelector(".title"),this.list=this.container.querySelector(".data-point-list"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",function(){i.hideTip()})}},{key:"fill",value:function(){var i,a=this;this.index&&this.container.setAttribute("data-point-index",this.index),i=this.titleValueFirst?"<strong>".concat(this.titleValue,"</strong>").concat(this.titleName):"".concat(this.titleName,"<strong>").concat(this.titleValue,"</strong>"),this.listValues.length>4?this.list.classList.add("tooltip-grid"):this.list.classList.remove("tooltip-grid"),this.title.innerHTML=i,this.dataPointList.innerHTML="",this.listValues.map(function(t,n){var s=a.colors[n]||"black",r=t.formatted===0||t.formatted?t.formatted:t.value,o=E.create("li",{innerHTML:'<div class="tooltip-legend" style="background: '.concat(s,`;"></div>
					<div>
						<div class="tooltip-value">`).concat(r===0||r?r:"",`</div>
						<div class="tooltip-label">`).concat(t.title?t.title:"",`</div>
					</div>`)});a.dataPointList.appendChild(o)})}},{key:"calcPosition",value:function(){var i=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-7.48,this.left=this.x-i/2;var a=this.parent.offsetWidth-i,t=this.container.querySelector(".svg-pointer");if(this.left<0)t.style.left="calc(50% - ".concat(-1*this.left,"px)"),this.left=0;else if(this.left>a){var n=this.left-a,s="calc(50% + ".concat(n,"px)");t.style.left=s,this.left=a}else t.style.left="50%"}},{key:"setValues",value:function(i,a){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;this.titleName=t.name,this.titleValue=t.value,this.listValues=n,this.x=i,this.y=a,this.titleValueFirst=t.valueFirst||0,this.index=s,this.refresh()}},{key:"hideTip",value:function(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}},{key:"showTip",value:function(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}]),e}();function St(e){return parseFloat(e.toFixed(2))}function st(e,i,a){var t=arguments.length>3&&arguments[3]!==void 0&&arguments[3];a||(a=t?e[0]:e[e.length-1]);var n=new Array(Math.abs(i)).fill(a);return e=t?n.concat(e):e.concat(n)}function vt(e,i){return(e+"").length*i}function Z(e,i){return{x:Math.sin(e*mt)*i,y:Math.cos(e*mt)*i}}function O(e){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return!Number.isNaN(e)&&e!==void 0&&!!Number.isFinite(e)&&!(i&&e<0)}function Ft(e){return Number(Math.round(e+"e4")+"e-4")}function rt(e){var i,a,t;if(e instanceof Date)return new Date(e.getTime());if(J(e)!=="object"||e===null)return e;for(t in i=Array.isArray(e)?[]:{},e)a=e[t],i[t]=rt(a);return i}function yt(e,i){var a,t;return e<=i?(a=i-e,t=e):(a=e-i,t=i),[a,t]}function D(e,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i.length-e.length;return a>0?e=st(e,a):i=st(i,a),[e,i]}function le(e,i){if(e)return e.length>i?e.slice(0,i-3)+"...":e}function ce(e){var i;if(typeof e=="number")i=e;else if(typeof e=="string"&&(i=Number(e),Number.isNaN(i)))return e;var a=Math.floor(Math.log10(Math.abs(i)));if(a<=2)return i;var t=Math.floor(a/3),n=Math.pow(10,a-3*t)*+(i/Math.pow(10,a)).toFixed(1);return Math.round(100*n)/100+["","K","M","B","T"][t]}function bt(e,i){for(var a=[],t=(Math.min(e.length,i.length),0);t<e.length;t++)a.push([e[t],i[t]]);var n=function(s,r,o,l){var c,u,h,d,p=(c=r||s,h=(u=o||s)[0]-c[0],d=u[1]-c[1],{length:Math.sqrt(Math.pow(h,2)+Math.pow(d,2)),angle:Math.atan2(d,h)}),g=p.angle+(l?Math.PI:0),f=.2*p.length;return[s[0]+Math.cos(g)*f,s[1]+Math.sin(g)*f]};return function(s,r){return s.reduce(function(o,l,c,u){return c===0?"".concat(l[0],",").concat(l[1]):"".concat(o," ").concat(r(l,c,u))},"")}(a,function(s,r,o){var l=n(o[r-1],o[r-2],s),c=n(s,o[r-1],o[r+1],!0);return"C ".concat(l[0],",").concat(l[1]," ").concat(c[0],",").concat(c[1]," ").concat(s[0],",").concat(s[1])})}function xt(e,i){return typeof e=="string"?(i||document).querySelector(e):e||null}function v(e,i){var a=document.createElementNS("http://www.w3.org/2000/svg",e);for(var t in i){var n=i[t];if(t==="inside")xt(n).appendChild(a);else if(t==="around"){var s=xt(n);s.parentNode.insertBefore(a,s),a.appendChild(s)}else t==="styles"?J(n)==="object"&&Object.keys(n).map(function(r){a.style[r]=n[r]}):(t==="className"&&(t="class"),t==="innerHTML"?a.textContent=n:a.setAttribute(t,n))}return a}function ue(e,i){return v("linearGradient",{inside:e,id:i,x1:0,x2:0,y1:0,y2:1})}function tt(e,i,a,t){return v("stop",{inside:e,style:"stop-color: ".concat(a),offset:i,"stop-opacity":t})}function ot(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,t={className:e,transform:i};return a&&(t.inside=a),v("g",t)}function _(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"none",t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"none",n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:2;return v("path",{className:i,d:e,styles:{stroke:a,fill:t,"stroke-width":n}})}function he(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+i.x,c=a.y+i.y;return"M".concat(a.x," ").concat(a.y,`
		L`).concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(n?1:0,`
		`).concat(l," ").concat(c," z")}function de(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+i.x,c=2*a.y,u=a.y+i.y;return"M".concat(a.x," ").concat(a.y,`
		L`).concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(n?1:0,`
		`).concat(l," ").concat(c,` z
		L`).concat(r," ").concat(c,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(n?1:0,`
		`).concat(l," ").concat(u," z")}function pe(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+i.x,c=a.y+i.y;return"M".concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(n?1:0,`
		`).concat(l," ").concat(c)}function fe(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=a.x+e.x,o=a.y+e.y,l=a.x+i.x,c=2*t+o,u=a.y+e.y;return"M".concat(r," ").concat(o,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(n?1:0,`
		`).concat(l," ").concat(c,`
		M`).concat(r," ").concat(c,`
		A `).concat(t," ").concat(t," 0 ").concat(s," ").concat(n?1:0,`
		`).concat(l," ").concat(u)}function kt(e,i){var a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],t="path-fill-gradient-"+i+"-"+(a?"lighter":"default"),n=ue(e,t),s=[1,.6,.2];return a&&(s=[.15,.05,0]),tt(n,"0%",i,s[0]),tt(n,"50%",i,s[1]),tt(n,"100%",i,s[2]),t}function ge(e,i,a){var t=a/2,n=i-t;return"M".concat(e,",0 h").concat(n," q").concat(t,",0 ").concat(t,",").concat(t," q0,").concat(t," -").concat(t,",").concat(t," h-").concat(n," v").concat(a,"z")}function me(e,i,a){var t=a/2,n=i-t;return"M".concat(e+t,",0 h").concat(n," v").concat(a," h-").concat(n," q-").concat(t,", 0 -").concat(t,",-").concat(t," q0,-").concat(t," ").concat(t,",-").concat(t,"z")}function _t(e,i,a,t,n){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"none",r=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},o={className:e,x:i,y:a,width:t,height:t,rx:n,fill:s};return Object.keys(r).map(function(l){o[l]=r[l]}),v("rect",o)}function zt(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"none",s=arguments.length>5?arguments[5]:void 0,r=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,l=arguments.length>8&&arguments[8]!==void 0&&arguments[8];o||(o=10);var c={className:"legend-dot",x:0,y:4-a,height:a,width:a,rx:t,fill:n},u=v("text",{className:"legend-dataset-label",x:a,y:0,dx:o+"px",dy:o/3+"px","font-size":1.6*o+"px","text-anchor":"start",innerHTML:s=l?le(s,18):s}),h=null;r&&(h=v("text",{className:"legend-dataset-value",x:a,y:20,dx:"10px",dy:10/3+"px","font-size":"12px","text-anchor":"start",innerHTML:r}));var d=v("g",{transform:"translate(".concat(e,", ").concat(i,")")});return d.appendChild(v("rect",c)),d.appendChild(u),r&&h&&d.appendChild(h),d}function Y(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},s=n.fontSize||10,r=n.dy!==void 0?n.dy:s/2,o=n.fill||"var(--charts-label-color)",l=n.textAnchor||"start";return v("text",{className:e,x:i,y:a,dy:r+"px","font-size":s+"px",fill:o,"text-anchor":l,innerHTML:t})}function ve(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},s=v("line",{className:"line-vertical "+n.className,x1:0,x2:0,y1:a,y2:t,styles:{stroke:n.stroke}}),r=v("text",{x:0,y:a>t?a+4:a-4-10,dy:"10px","font-size":"10px","text-anchor":"middle",innerHTML:i+""}),o=v("g",{transform:"translate(".concat(e,", 0)")});return o.appendChild(s),o.appendChild(r),o}function wt(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};n.lineType||(n.lineType=""),n.shortenNumbers&&(i=n.numberFormatter?n.numberFormatter(i):ce(i));var s="line-horizontal "+n.className+(n.lineType==="dashed"?"dashed":""),r=v("line",{className:s,x1:a,x2:t,y1:0,y2:0,styles:{stroke:n.stroke}}),o=v("text",{x:a<t?a-4:a+4,y:0,dy:"3px","font-size":"10px","text-anchor":a<t?"end":"start",innerHTML:i+""}),l=v("g",{transform:"translate(0, ".concat(e,")"),"stroke-opacity":1});return o!==0&&o!=="0"||(l.style.stroke="rgba(27, 31, 35, 0.6)"),l.appendChild(r),l.appendChild(o),l}function At(e,i,a,t){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,r=arguments.length>6&&arguments[6]!==void 0&&arguments[6],o=v("circle",{style:"fill: ".concat(t,"; ").concat(r?"stroke: ".concat(t):""),"data-point-index":s,cx:e,cy:i,r:a});if((n+="")||n.length){o.setAttribute("cy",0),o.setAttribute("cx",0);var l=v("text",{className:"data-point-value",x:0,y:0,dy:-5-a+"px","font-size":"10px","text-anchor":"middle",innerHTML:n}),c=v("g",{"data-point-index":s,transform:"translate(".concat(e,", ").concat(i,")")});return c.appendChild(o),c.appendChild(l),c}return o}var ye={bar:function(e){var i;e.nodeName!=="rect"&&(i=e.getAttribute("transform"),e=e.childNodes[0]);var a=e.cloneNode();return a.style.fill="#000000",a.style.opacity="0.4",i&&a.setAttribute("transform",i),a},dot:function(e){var i;e.nodeName!=="circle"&&(i=e.getAttribute("transform"),e=e.childNodes[0]);var a=e.cloneNode(),t=e.getAttribute("r"),n=e.getAttribute("fill");return a.setAttribute("r",parseInt(t)+4),a.setAttribute("fill",n),a.style.opacity="0.6",i&&a.setAttribute("transform",i),a},heat_square:function(e){var i;e.nodeName!=="circle"&&(i=e.getAttribute("transform"),e=e.childNodes[0]);var a=e.cloneNode(),t=e.getAttribute("r"),n=e.getAttribute("fill");return a.setAttribute("r",parseInt(t)+4),a.setAttribute("fill",n),a.style.opacity="0.6",i&&a.setAttribute("transform",i),a}},be={bar:function(e,i){var a;e.nodeName!=="rect"&&(a=e.getAttribute("transform"),e=e.childNodes[0]);var t=["x","y","width","height"];Object.values(e.attributes).filter(function(n){return t.includes(n.name)&&n.specified}).map(function(n){i.setAttribute(n.name,n.nodeValue)}),a&&i.setAttribute("transform",a)},dot:function(e,i){var a;e.nodeName!=="circle"&&(a=e.getAttribute("transform"),e=e.childNodes[0]);var t=["cx","cy"];Object.values(e.attributes).filter(function(n){return t.includes(n.name)&&n.specified}).map(function(n){i.setAttribute(n.name,n.nodeValue)}),a&&i.setAttribute("transform",a)},heat_square:function(e,i){var a;e.nodeName!=="circle"&&(a=e.getAttribute("transform"),e=e.childNodes[0]);var t=["cx","cy"];Object.values(e.attributes).filter(function(n){return t.includes(n.name)&&n.specified}).map(function(n){i.setAttribute(n.name,n.nodeValue)}),a&&i.setAttribute("transform",a)}},xe={pink:"#F683AE",blue:"#318AD8",green:"#48BB74",grey:"#A6B1B9",red:"#F56B6B",yellow:"#FACF7A",purple:"#44427B",teal:"#5FD8C4",cyan:"#15CCEF",orange:"#F8814F","light-pink":"#FED7E5","light-blue":"#BFDDF7","light-green":"#48BB74","light-grey":"#F4F5F6","light-red":"#F6DFDF","light-yellow":"#FEE9BF","light-purple":"#E8E8F7","light-teal":"#D3FDF6","light-cyan":"#DDF8FD","light-orange":"#FECDB8"};function I(e,i,a,t){var n=typeof i=="string"?i:i.join(", ");return[e,{transform:a.join(", ")},t,"easein","translate",{transform:n}]}function Dt(e,i,a){return I(e,[0,a],[0,i],350)}function Ct(e,i){return[e,{d:i},350,"easein"]}var ke={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function we(e,i,a){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"linear",n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},r=e.cloneNode(!0),o=e.cloneNode(!0);for(var l in i){var c=void 0;c=l==="transform"?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");var u=s[l]||e.getAttribute(l),h=i[l],d={attributeName:l,from:u,to:h,begin:"0s",dur:a/1e3+"s",values:u+";"+h,keySplines:ke[t],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var p in n&&(d.type=n),d)c.setAttribute(p,d[p]);r.appendChild(c),n?o.setAttribute(l,"translate(".concat(h,")")):o.setAttribute(l,h)}return[r,o]}function lt(e,i){e.style.transform=i,e.style.webkitTransform=i,e.style.msTransform=i,e.style.mozTransform=i,e.style.oTransform=i}function Ae(e,i){var a=[],t=[];i.map(function(s){var r,o,l=s[0],c=l.parentNode;s[0]=l;var u=k(we.apply(void 0,T(s)),2);r=u[0],o=u[1],a.push(o),t.push([r,c]),c.replaceChild(r,l)});var n=e.cloneNode(!0);return t.map(function(s,r){s[1].replaceChild(a[r],s[0]),i[r][0]=a[r]}),n}function De(e,i,a){if(a.length!==0){var t=Ae(i,a);i.parentNode==e&&(e.removeChild(i),e.appendChild(t)),setTimeout(function(){t.parentNode==e&&(e.removeChild(t),e.appendChild(i))},250)}}var ht=function(){function e(i,a){if(P(this,e),a=rt(a),this.parent=typeof i=="string"?document.querySelector(i):i,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=a,this.title=a.title||"",this.type=a.type||"",this.realData=this.prepareData(a.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(a.colors,this.type),this.config={showTooltip:1,showLegend:a.showLegend!==void 0?a.showLegend:1,isNavigable:a.isNavigable||0,animate:a.animate!==void 0?a.animate:1,disableEntryAnimation:a.disableEntryAnimation||0,truncateLegends:a.truncateLegends||1},this.measures=JSON.parse(JSON.stringify(se));var t=this.measures;this.setMeasures(a),this.title.length||(t.titleHeight=0),this.config.showLegend||(t.legendHeight=0),this.argHeight=a.height||t.baseHeight,this.state={},this.options={},this.initTimeout=700,this.config.isNavigable&&(this.overlays=[]),this.configure(a)}return N(e,[{key:"prepareData",value:function(i){return i}},{key:"prepareFirstData",value:function(i){return i}},{key:"validateColors",value:function(i,a){var t=[];return(i=(i||[]).concat(re[a])).forEach(function(n){var s=function(r){return/rgb[a]{0,1}\([\d, ]+\)/gim.test(r)?/\D+(\d*)\D+(\d*)\D+(\d*)/gim.exec(r).map(function(o,l){return l!==0?Number(o).toString(16):"#"}).reduce(function(o,l){return"".concat(o).concat(l)}):xe[r]||r}(n);(function(r){return/(^\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i.test(r)||/(^\s*)(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/i.test(r)})(s)?t.push(s):console.warn('"'+n+'" is not a valid color.')}),t}},{key:"setMeasures",value:function(){}},{key:"configure",value:function(){var i=this,a=this.argHeight;this.baseHeight=a,this.height=a-ut(this.measures),this.boundDrawFn=function(){return i.draw(!0)},ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.boundDrawFn),this.resizeObserver.observe(this.parent)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}},{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}},{key:"setup",value:function(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}},{key:"makeContainer",value:function(){this.parent.innerHTML="";var i={inside:this.parent,className:"chart-container"};this.independentWidth&&(i.styles={width:this.independentWidth+"px"}),this.container=E.create("div",i)}},{key:"makeTooltip",value:function(){this.tip=new oe({parent:this.container,colors:this.colors}),this.bindTooltip()}},{key:"bindTooltip",value:function(){}},{key:"draw",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];a&&ae(this.parent)||(this.updateWidth(),this.calc(a),this.makeChartArea(),this.setupComponents(),this.components.forEach(function(n){return n.setup(i.drawArea)}),this.render(this.components,!1),t&&(this.data=this.realData,setTimeout(function(){i.update(i.data,!0)},this.initTimeout)),this.config.showLegend&&this.renderLegend(),this.setupNavigation(t))}},{key:"calc",value:function(){}},{key:"updateWidth",value:function(){var i,a,t;this.baseWidth=(i=this.parent,a=window.getComputedStyle(i),t=parseFloat(a.paddingLeft)+parseFloat(a.paddingRight),i.clientWidth-t),this.width=this.baseWidth-it(this.measures)}},{key:"makeChartArea",value:function(){this.svg&&this.container.removeChild(this.svg);var i,a,t,n,s=this.measures;this.svg=(i=this.container,a="frappe-chart chart",t=this.baseWidth,n=this.baseHeight,v("svg",{className:a,inside:i,width:t,height:n})),this.svgDefs=v("defs",{inside:this.svg}),this.title.length&&(this.titleEL=Y("title",s.margins.left,s.margins.top,this.title,{fontSize:s.titleFontSize,fill:"#666666",dy:s.titleFontSize}));var r=X(s);this.drawArea=ot(this.type+"-chart chart-draw-area","translate(".concat(G(s),", ").concat(r,")")),this.config.showLegend&&(r+=this.height+s.paddings.bottom,this.legendArea=ot("chart-legend","translate(".concat(G(s),", ").concat(r,")"))),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(G(s),X(s))}},{key:"updateTipOffset",value:function(i,a){this.tip.offset={x:i,y:a}}},{key:"setupComponents",value:function(){this.components=new Map}},{key:"update",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];i||console.error("No data to update."),a||(i=rt(i));var t=a?!this.config.disableEntryAnimation:this.config.animate;this.data=this.prepareData(i),this.calc(),this.render(this.components,t)}},{key:"render",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.components,t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.config.isNavigable&&this.overlays.map(function(s){return s.parentNode.removeChild(s)});var n=[];a.forEach(function(s){n=n.concat(s.update(t))}),n.length>0?(De(this.container,this.svg,n),setTimeout(function(){a.forEach(function(s){return s.make()}),i.updateNav()},400)):(a.forEach(function(s){return s.make()}),this.updateNav())}},{key:"updateNav",value:function(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}},{key:"renderLegend",value:function(i){var a=this;this.legendArea.textContent="";var t=0,n=0;i.map(function(s,r){var o=Math.floor(a.width/150);t>o&&(t=0,n+=a.config.legendRowHeight);var l=150*t,c=a.makeLegend(s,r,l,n);a.legendArea.appendChild(c),t++})}},{key:"makeLegend",value:function(){}},{key:"setupNavigation",value:function(){var i=this,a=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.config.isNavigable&&a&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",function(t){ie(i.container)&&(t=t||window.event,i.keyActions[t.keyCode]&&i.keyActions[t.keyCode]())}))}},{key:"makeOverlay",value:function(){}},{key:"updateOverlay",value:function(){}},{key:"bindOverlay",value:function(){}},{key:"bindUnits",value:function(){}},{key:"onLeftArrow",value:function(){}},{key:"onRightArrow",value:function(){}},{key:"onUpArrow",value:function(){}},{key:"onDownArrow",value:function(){}},{key:"onEnterKey",value:function(){}},{key:"addDataPoint",value:function(){}},{key:"removeDataPoint",value:function(){}},{key:"getDataPoint",value:function(){}},{key:"setCurrentDataPoint",value:function(){}},{key:"updateDataset",value:function(){}},{key:"export",value:function(){var i=function(a){var t=a.cloneNode(!0);t.classList.add("chart-container"),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var n=E.create("style",{innerHTML:".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}"});t.insertBefore(n,t.firstChild);var s=E.create("div");return s.appendChild(t),s.innerHTML}(this.svg);(function(a,t){var n=document.createElement("a");n.style="display: none";var s=new Blob(t,{type:"image/svg+xml; charset=utf-8"}),r=window.URL.createObjectURL(s);n.href=r,n.download=a,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(r)},300)})(this.title||"Chart",[i])}}]),e}(),Rt=function(e){R(a,ht);var i=H(a);function a(t,n){return P(this,a),i.call(this,t,n)}return N(a,[{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),this.config.formatTooltipY=(t.tooltipOptions||{}).formatTooltipY,this.config.maxSlices=t.maxSlices||20,this.config.maxLegendPoints=t.maxLegendPoints||20,this.config.legendRowHeight=60}},{key:"calc",value:function(){var t=this,n=this.state,s=this.config.maxSlices;n.sliceTotals=[];var r=this.data.labels.map(function(u,h){var d=0;return t.data.datasets.map(function(p){d+=p.values[h]}),[d,u]}).filter(function(u){return u[0]>=0}),o=r;if(r.length>s){r.sort(function(u,h){return h[0]-u[0]}),o=r.slice(0,s-1);var l=r.slice(s-1),c=0;l.map(function(u){c+=u[0]}),o.push([c,"Rest"]),this.colors[s-1]="grey"}n.labels=[],o.map(function(u){n.sliceTotals.push(Ft(u[0])),n.labels.push(u[1])}),n.grandTotal=n.sliceTotals.reduce(function(u,h){return u+h},0),this.center={x:this.width/2,y:this.height/2}}},{key:"renderLegend",value:function(){var t=this.state;this.legendArea.textContent="",this.legendTotals=t.sliceTotals.slice(0,this.config.maxLegendPoints),L(w(a.prototype),"renderLegend",this).call(this,this.legendTotals)}},{key:"makeLegend",value:function(t,n,s,r){var o=this.config.formatTooltipY?this.config.formatTooltipY(t):t;return zt(s,r,12,3,this.colors[n],this.state.labels[n],o,null,this.config.truncateLegends)}}]),a}(),Ce=["January","February","March","April","May","June","July","August","September","October","November","December"],Le=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Lt(e){var i=new Date(e);return i.setMinutes(i.getMinutes()-i.getTimezoneOffset()),i}function et(e){var i=e.getDate(),a=e.getMonth()+1;return[e.getFullYear(),(a>9?"":"0")+a,(i>9?"":"0")+i].join("-")}function S(e){return new Date(e.getTime())}function nt(e,i){var a=Wt(e);return Math.ceil(function(t,n){return(Lt(n)-Lt(t))/864e5}(a,i)/7)}function Te(e,i){return e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()}function Ht(e){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=Ce[e];return i?a.slice(0,3):a}function Tt(e,i){return new Date(i,e+1,0)}function Wt(e){var i=S(e),a=i.getDay();return a!==0&&z(i,-1*a),i}function z(e,i){e.setDate(e.getDate()+i)}var Pe=function(){function e(i){var a=i.layerClass,t=a===void 0?"":a,n=i.layerTransform,s=n===void 0?"":n,r=i.constants,o=i.getData,l=i.makeElements,c=i.animateElements;P(this,e),this.layerTransform=s,this.constants=r,this.makeElements=l,this.getData=o,this.animateElements=c,this.store=[],this.labels=[],this.layerClass=t,this.layerClass=typeof this.layerClass=="function"?this.layerClass():this.layerClass,this.refresh()}return N(e,[{key:"refresh",value:function(i){this.data=i||this.getData()}},{key:"setup",value:function(i){this.layer=ot(this.layerClass,this.layerTransform,i)}},{key:"make",value:function(){this.render(this.data),this.oldData=this.data}},{key:"render",value:function(i){var a=this;this.store=this.makeElements(i),this.layer.textContent="",this.store.forEach(function(t){a.layer.appendChild(t)}),this.labels.forEach(function(t){a.layer.appendChild(t)})}},{key:"update",value:function(){var i=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.refresh();var a=[];return i&&(a=this.animateElements(this.data)||[]),a}}]),e}(),Pt={donutSlices:{layerClass:"donut-slices",makeElements:function(e){return e.sliceStrings.map(function(i,a){var t=_(i,"donut-path",e.colors[a],"none",e.strokeWidth);return t.style.transition="transform .3s;",t})},animateElements:function(e){return this.store.map(function(i,a){return Ct(i,e.sliceStrings[a])})}},pieSlices:{layerClass:"pie-slices",makeElements:function(e){return e.sliceStrings.map(function(i,a){var t=_(i,"pie-path","none",e.colors[a]);return t.style.transition="transform .3s;",t})},animateElements:function(e){return this.store.map(function(i,a){return Ct(i,e.sliceStrings[a])})}},percentageBars:{layerClass:"percentage-bars",makeElements:function(e){var i=this,a=e.xPositions.length;return e.xPositions.map(function(t,n){var s=n==a-1,r=n==0;return function(o,l,c,u,h,d){var p=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"none";if(d){var g=ge(o,c,u);return _(g,"percentage-bar",null,p)}if(h){var f=me(o,c,u);return _(f,"percentage-bar",null,p)}var m={className:"percentage-bar",x:o,y:l,width:c,height:u,fill:p};return v("rect",m)}(t,0,e.widths[n],i.constants.barHeight,r,s,e.colors[n])})},animateElements:function(e){if(e)return[]}},yAxis:{layerClass:"y axis",makeElements:function(e){var i=this;return e.positions.map(function(a,t){return function(n,s,r){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};O(n)||(n=0),o.pos||(o.pos="left"),o.offset||(o.offset=0),o.mode||(o.mode="span"),o.stroke||(o.stroke="#E2E6E9"),o.className||(o.className="");var l=-6,c=o.mode==="span"?r+6:0;return o.mode==="tick"&&o.pos==="right"&&(l=r+6,c=r),l+=o.offset,c+=o.offset,typeof s=="number"&&(s=Ft(s)),wt(n,s,l,c,{className:o.className,lineType:o.lineType,shortenNumbers:o.shortenNumbers,numberFormatter:o.numberFormatter})}(a,e.labels[t],i.constants.width,{mode:i.constants.mode,pos:i.constants.pos,shortenNumbers:i.constants.shortenNumbers,numberFormatter:i.constants.numberFormatter})})},animateElements:function(e){var i=e.positions,a=e.labels,t=this.oldData.positions,n=this.oldData.labels,s=k(D(t,i),2);t=s[0],i=s[1];var r=k(D(n,a),2);return n=r[0],a=r[1],this.render({positions:t,labels:a}),this.store.map(function(o,l){return Dt(o,i[l],t[l])})}},xAxis:{layerClass:"x axis",makeElements:function(e){var i=this;return e.positions.map(function(a,t){return function(n,s,r){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};O(n)||(n=0),o.pos||(o.pos="bottom"),o.offset||(o.offset=0),o.mode||(o.mode="span"),o.className||(o.className="");var l=r+6,c=o.mode==="span"?-6:r;return o.mode==="tick"&&o.pos==="top"&&(l=-6,c=0),ve(n,s,l,c,{className:o.className,lineType:o.lineType})}(a,e.calcLabels[t],i.constants.height,{mode:i.constants.mode,pos:i.constants.pos})})},animateElements:function(e){var i=e.positions,a=e.calcLabels,t=this.oldData.positions,n=this.oldData.calcLabels,s=k(D(t,i),2);t=s[0],i=s[1];var r=k(D(n,a),2);return n=r[0],a=r[1],this.render({positions:t,calcLabels:a}),this.store.map(function(o,l){return function(c,u,h){return I(c,[h,0],[u,0],350)}(o,i[l],t[l])})}},yMarkers:{layerClass:"y-markers",makeElements:function(e){var i=this;return e.map(function(a){return function(t,n,s){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};O(t)||(t=0),r.labelPos||(r.labelPos="right"),r.lineType||(r.lineType="dashed");var o=r.labelPos==="left"?4:s-vt(n,5)-4,l=v("text",{className:"chart-label",x:o,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:n+""}),c=wt(t,"",0,s,{stroke:r.stroke||"#E2E6E9",className:r.className||"",lineType:r.lineType});return c.appendChild(l),c}(a.position,a.label,i.constants.width,{labelPos:a.options.labelPos,stroke:a.options.stroke,mode:"span",lineType:a.options.lineType})})},animateElements:function(e){var i=k(D(this.oldData,e),2);this.oldData=i[0];var a=(e=i[1]).map(function(r){return r.position}),t=e.map(function(r){return r.label}),n=e.map(function(r){return r.options}),s=this.oldData.map(function(r){return r.position});return this.render(s.map(function(r,o){return{position:s[o],label:t[o],options:n[o]}})),this.store.map(function(r,o){return Dt(r,a[o],s[o])})}},yRegions:{layerClass:"y-regions",makeElements:function(e){var i=this;return e.map(function(a){return function(t,n,s,r){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},l=t-n,c=v("rect",{className:"bar mini",styles:{fill:o.fill||"rgba(228, 234, 239, 0.49)",stroke:o.stroke||"#E2E6E9","stroke-dasharray":"".concat(s,", ").concat(l)},x:0,y:0,width:s,height:l});o.labelPos||(o.labelPos="right");var u=o.labelPos==="left"?4:s-vt(r+"",4.5)-4,h=v("text",{className:"chart-label",x:u,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:r+""}),d=v("g",{transform:"translate(0, ".concat(n,")")});return d.appendChild(c),d.appendChild(h),d}(a.startPos,a.endPos,i.constants.width,a.label,{labelPos:a.options.labelPos,stroke:a.options.stroke,fill:a.options.fill})})},animateElements:function(e){var i=k(D(this.oldData,e),2);this.oldData=i[0];var a=(e=i[1]).map(function(c){return c.endPos}),t=e.map(function(c){return c.label}),n=e.map(function(c){return c.startPos}),s=e.map(function(c){return c.options}),r=this.oldData.map(function(c){return c.endPos}),o=this.oldData.map(function(c){return c.startPos});this.render(r.map(function(c,u){return{startPos:o[u],endPos:r[u],label:t[u],options:s[u]}}));var l=[];return this.store.map(function(c,u){l=l.concat(function(h,d,p,g){var f=d-p,m=h.childNodes[0],y=m.getAttribute("width");return[[m,{height:f,"stroke-dasharray":"".concat(y,", ").concat(f)},350,"easein"],I(h,[0,g],[0,p],350)]}(c,n[u],a[u],r[u]))}),l}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements:function(e){var i=this,a=this.constants,t=a.index,n=a.colWidth,s=a.rowHeight,r=a.squareSize,o=a.radius,l=a.xTranslate,c=l,u=0;return this.serializedSubDomains=[],e.cols.map(function(h,d){d===1&&i.labels.push(Y("domain-name",c,-12,Ht(t,!0).toUpperCase(),{fontSize:9})),h.map(function(p,g){if(p.fill){var f={"data-date":p.yyyyMmDd,"data-value":p.dataValue,"data-day":g},m=_t("day",c,u,r,o,p.fill,f);i.serializedSubDomains.push(m)}u+=s}),u=0,c+=n}),this.serializedSubDomains},animateElements:function(e){if(e)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements:function(e){var i=this.constants;return this.unitType="bar",this.units=e.yPositions.map(function(a,t){return function(n,s,r,o){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,h=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},d=yt(s,h.zeroLine),p=k(d,2),g=p[0],f=p[1];f-=u,g===0&&(g=h.minHeight,f-=h.minHeight),O(n)||(n=0),O(f)||(f=0),O(g,!0)||(g=0),O(r,!0)||(r=0);var m=v("rect",{className:"bar mini",style:"fill: ".concat(o),"data-point-index":c,x:n,y:f,width:r,height:g});if((l+="")||l.length){m.setAttribute("y",0),m.setAttribute("x",0);var y=v("text",{className:"data-point-value",x:r/2,y:0,dy:"-5px","font-size":"10px","text-anchor":"middle",innerHTML:l}),x=v("g",{"data-point-index":c,transform:"translate(".concat(n,", ").concat(f,")")});return x.appendChild(m),x.appendChild(y),x}return m}(e.xPositions[t],a,e.barWidth,i.color,e.labels[t],t,e.offsets[t],{zeroLine:e.zeroLine,barsWidth:e.barsWidth,minHeight:i.minHeight})}),this.units},animateElements:function(e){var i=e.xPositions,a=e.yPositions,t=e.offsets,n=e.labels,s=this.oldData.xPositions,r=this.oldData.yPositions,o=this.oldData.offsets,l=this.oldData.labels,c=k(D(s,i),2);s=c[0],i=c[1];var u=k(D(r,a),2);r=u[0],a=u[1];var h=k(D(o,t),2);o=h[0],t=h[1];var d=k(D(l,n),2);l=d[0],n=d[1],this.render({xPositions:s,yPositions:r,offsets:o,labels:n,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});var p=[];return this.store.map(function(g,f){p=p.concat(function(m,y,x,A){var b=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,C=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},M=yt(x,C.zeroLine),F=k(M,2),dt=F[0],K=F[1];if(K-=b,m.nodeName!=="rect"){var jt=m.childNodes[0],Yt=[jt,{width:A,height:dt},350,"easein"],$t=m.getAttribute("transform").split("(")[1].slice(0,-1),Vt=I(m,$t,[y,K],350);return[Yt,Vt]}return[[m,{width:A,height:dt,x:y,y:K},350,"easein"]]}(g,i[f],a[f],e.barWidth,t[f],{zeroLine:e.zeroLine}))}),p}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements:function(e){var i=this.constants;if(this.unitType="dot",this.paths={},i.hideLine||(this.paths=function(n,s,r){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},c=s.map(function(m,y){return n[y]+","+m}),u=c.join("L");o.spline&&(u=bt(n,s));var h=_("M"+u,"line-graph-path",r);if(o.heatline){var d=kt(l.svgDefs,r);h.style.stroke="url(#".concat(d,")")}var p={path:h};if(o.regionFill){var g=kt(l.svgDefs,r,!0),f="M"+"".concat(n[0],",").concat(l.zeroLine,"L")+u+"L".concat(n.slice(-1)[0],",").concat(l.zeroLine);p.region=_(f,"region-fill","none","url(#".concat(g,")"))}return p}(e.xPositions,e.yPositions,i.color,{heatline:i.heatline,regionFill:i.regionFill,spline:i.spline},{svgDefs:i.svgDefs,zeroLine:e.zeroLine})),this.units=[],i.showDots&&(this.units=e.yPositions.map(function(n,s){return At(e.xPositions[s],n,e.radius,i.color,i.valuesOverPoints?e.values[s]:"",s,i.hideDotBorder)})),i.trailingDot&&!i.showDots){var a=e.yPositions.length-1,t=At(e.xPositions[a],e.yPositions[a],e.radius,i.color,i.valuesOverPoints?e.values[a]:"",a,i.hideDotBorder);this.units.push(t)}return Object.values(this.paths).concat(this.units)},animateElements:function(e){var i=e.xPositions,a=e.yPositions,t=e.values,n=this.oldData.xPositions,s=this.oldData.yPositions,r=this.oldData.values,o=k(D(n,i),2);n=o[0],i=o[1];var l=k(D(s,a),2);s=l[0],a=l[1];var c=k(D(r,t),2);r=c[0],t=c[1],this.render({xPositions:n,yPositions:s,values:t,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});var u=[];return Object.keys(this.paths).length&&(u=u.concat(function(h,d,p,g,f){var m=[],y=p.map(function(M,F){return d[F]+","+M}).join("L");f&&(y=bt(d,p));var x=[h.path,{d:"M"+y},350,"easein"];if(m.push(x),h.region){var A="".concat(d[0],",").concat(g,"L"),b="L".concat(d.slice(-1)[0],", ").concat(g),C=[h.region,{d:"M"+A+y+b},350,"easein"];m.push(C)}return m}(this.paths,i,a,e.zeroLine,this.constants.spline))),this.units.length&&this.units.map(function(h,d){u=u.concat(function(p,g,f){if(p.nodeName!=="circle"){var m=p.getAttribute("transform").split("(")[1].slice(0,-1);return[I(p,m,[g,f],350)]}return[[p,{cx:g,cy:f},350,"easein"]]}(h,i[d],a[d]))}),u}}};function V(e,i,a){var t=Object.keys(Pt).filter(function(s){return e.includes(s)}),n=Pt[t[0]];return Object.assign(n,{constants:i,getData:a}),new Pe(n)}var Me=function(e){R(a,Rt);var i=H(a);function a(t,n){var s;return P(this,a),(s=i.call(this,t,n)).type="percentage",s.setup(),s}return N(a,[{key:"setMeasures",value:function(t){var n=this.measures;this.barOptions=t.barOptions||{};var s=this.barOptions;s.height=s.height||16,n.paddings.right=30,n.paddings.top=60,n.paddings.bottom=0,n.legendHeight=80,n.baseHeight=8*s.height+ut(n)}},{key:"setupComponents",value:function(){var t=this.state,n=[["percentageBars",{barHeight:this.barOptions.height},function(){return{xPositions:t.xPositions,widths:t.widths,colors:this.colors}}.bind(this)]];this.components=new Map(n.map(function(s){var r=V.apply(void 0,T(s));return[s[0],r]}))}},{key:"calc",value:function(){var t=this;L(w(a.prototype),"calc",this).call(this);var n=this.state;n.xPositions=[],n.widths=[];var s=0;n.sliceTotals.map(function(r){var o=t.width*r/n.grandTotal;n.widths.push(o),n.xPositions.push(s),s+=o})}},{key:"makeDataByIndex",value:function(){}},{key:"bindTooltip",value:function(){var t=this,n=this.state;this.container.addEventListener("mousemove",function(s){var r=t.components.get("percentageBars").store,o=s.target;if(r.includes(o)){var l=r.indexOf(o),c=q(t.container),u=q(o),h=o.getAttribute("width")||o.getBoundingClientRect().width,d=u.left-c.left+parseInt(h)/2,p=u.top-c.top,g=(t.formattedLabels&&t.formattedLabels.length>0?t.formattedLabels[l]:t.state.labels[l])+": ",f=n.sliceTotals[l]/n.grandTotal;t.tip.setValues(d,p,{name:g,value:(100*f).toFixed(1)+"%"}),t.tip.showTip()}})}}]),a}(),Mt=function(e){R(a,Rt);var i=H(a);function a(t,n){var s;return P(this,a),(s=i.call(this,t,n)).initTimeout=0,s.init=1,s.setup(),s}return N(a,[{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=t.hoverRadio||.1,this.config.startAngle=t.startAngle||0,this.type="pie",this.sliceName="pieSlices",this.arcFunc=he,this.shapeFunc=de,this.clockWise=t.clockWise||!1}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x:this.center.y}},{key:"calc",value:function(){var t=this;L(w(a.prototype),"calc",this).call(this);var n=this.state;this.radius=this.getRadius();var s=this.radius,r=this.clockWise,o=n.slicesProperties||[];n.sliceStrings=[],n.slicesProperties=[];var l=180-this.config.startAngle;n.sliceTotals.map(function(c,u){var h,d,p=l,g=c/n.grandTotal*360,f=g>180?1:0,m=r?-g:g,y=l+=m,x=Z(p,s),A=Z(y,s),b=t.init&&o[u];t.init?(h=b?b.startPosition:x,d=b?b.endPosition:x):(h=x,d=A);var C=g===360?t.shapeFunc(h,d,t.center,t.radius,r,f):t.arcFunc(h,d,t.center,t.radius,r,f);n.sliceStrings.push(C),n.slicesProperties.push({startPosition:x,endPosition:A,value:c,total:n.grandTotal,startAngle:p,endAngle:y,angle:m})}),this.init=0}},{key:"setupComponents",value:function(){var t=this.state,n=[["pieSlices",{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(n.map(function(s){var r=V.apply(void 0,T(s));return[s[0],r]}))}},{key:"calTranslateByAngle",value:function(t){var n=this.radius,s=this.hoverRadio,r=Z(t.startAngle+t.angle/2,n);return"translate3d(".concat(r.x*s,"px,").concat(r.y*s,"px,0)")}},{key:"hoverSlice",value:function(t,n,s,r){if(t){var o=this.colors[n];if(s){lt(t,this.calTranslateByAngle(this.state.slicesProperties[n]));var l=q(this.svg),c=r.pageX-l.left+10,u=r.pageY-l.top-10,h=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[n]:this.state.labels[n])+": ",d=(100*this.state.sliceTotals[n]/this.state.grandTotal).toFixed(1);this.tip.setValues(c,u,{name:h,value:d+"%"}),this.tip.showTip()}else this.resetHover(t,o)}}},{key:"resetHover",value:function(t,n){lt(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.fill=n}},{key:"bindTooltip",value:function(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}},{key:"mouseMove",value:function(t){var n=t.target,s=this.components.get(this.sliceName).store,r=this.curActiveSliceIndex,o=this.curActiveSlice;if(s.includes(n)){var l=s.indexOf(n);this.hoverSlice(o,r,!1),this.curActiveSlice=n,this.curActiveSliceIndex=l,this.hoverSlice(n,l,!0,t)}else this.mouseLeave()}},{key:"mouseLeave",value:function(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}]),a}();function j(e){if(e===0)return[0,0];if(isNaN(e))return{mantissa:-6755399441055744,exponent:972};var i=e>0?1:-1;if(!isFinite(e))return{mantissa:4503599627370496*i,exponent:972};e=Math.abs(e);var a=Math.floor(Math.log10(e));return[i*(e/Math.pow(10,a)),a]}function Ne(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Math.ceil(e),t=Math.floor(i),n=a-t,s=n,r=1;n>5&&(n%2!=0&&(n=++a-t),s=n/2,r=2),n<=2&&(r=n/(s=4)),n===0&&(s=5,r=1);for(var o=[],l=0;l<=s;l++)o.push(t+r*l);return o}function B(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=j(e),t=k(a,2),n=t[0],s=t[1],r=i?i/Math.pow(10,s):0,o=Ne(n=n.toFixed(6),r);return o=o.map(function(l){return l*Math.pow(10,s)})}function Ee(e){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=Math.max.apply(Math,T(e)),n=Math.min.apply(Math,T(e));a.max!==void 0&&(t=t>a.max?t:a.max),a.min!==void 0&&(n=n<a.min?n:a.min);var s=[];function r(h,d){for(var p=B(h),g=p[1]-p[0],f=0,m=1;f<d;m++)f+=g,p.unshift(-1*f);return p}if(t>=0&&n>=0)j(t)[1],s=i?B(t,n):B(t);else if(t>0&&n<0){var o=Math.abs(n);if(t>=o)j(t)[1],s=r(t,o);else{j(o)[1];var l=r(o,t);s=l.reverse().map(function(h){return-1*h})}}else if(t<=0&&n<=0){var c=Math.abs(n),u=Math.abs(t);j(c)[1],s=(s=i?B(c,u):B(c)).reverse().map(function(h){return-1*h})}return s}function Oe(e){var i,a=Bt(e);return e.indexOf(0)>=0?i=e.indexOf(0):e[0]>0?i=-1*e[0]/a:i=-1*e[e.length-1]/a+(e.length-1),i}function Bt(e){return e[1]-e[0]}function Se(e){return e[e.length-1]-e[0]}function U(e,i){return St(i.zeroLine-e*i.scaleMultiplier)}var Fe=function(e){R(a,ht);var i=H(a);function a(t,n){var s;P(this,a),(s=i.call(this,t,n)).type="heatmap",s.countLabel=n.countLabel||"";var r=["Sunday","Monday"],o=r.includes(n.startSubDomain)?n.startSubDomain:"Sunday";return s.startSubDomainIndex=r.indexOf(o),s.setup(),s}return N(a,[{key:"setMeasures",value:function(t){var n=this.measures;this.discreteDomains=t.discreteDomains===0?0:1,n.paddings.top=36,n.paddings.bottom=0,n.legendHeight=24,n.baseHeight=84+ut(n);var s=this.data,r=this.discreteDomains?12:0;this.independentWidth=12*(nt(s.start,s.end)+r)+it(n)}},{key:"updateWidth",value:function(){var t=this.discreteDomains?12:0,n=this.state.noOfWeeks?this.state.noOfWeeks:52;this.baseWidth=12*(n+t)+it(this.measures)}},{key:"prepareData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;if(t.start&&t.end&&t.start>t.end)throw new Error("Start date cannot be greater than end date.");if(t.start||(t.start=new Date,t.start.setFullYear(t.start.getFullYear()-1)),t.end||(t.end=new Date),t.dataPoints=t.dataPoints||{},parseInt(Object.keys(t.dataPoints)[0])>1e5){var n={};Object.keys(t.dataPoints).forEach(function(s){var r=new Date(1e3*s);n[et(r)]=t.dataPoints[s]}),t.dataPoints=n}return t}},{key:"calc",value:function(){var t=this.state;t.start=S(this.data.start),t.end=S(this.data.end),t.firstWeekStart=S(t.start),t.noOfWeeks=nt(t.start,t.end),t.distribution=function(n,s){for(var r=Math.max.apply(Math,T(n)),o=1/(s-1),l=[],c=0;c<s;c++){var u=r*(o*c);l.push(u)}return l}(Object.values(this.data.dataPoints),5),t.domainConfigs=this.getDomains()}},{key:"setupComponents",value:function(){var t=this,n=this.state,s=this.discreteDomains?0:1,r=n.domainConfigs.map(function(l,c){return["heatDomain",{index:l.index,colWidth:12,rowHeight:12,squareSize:10,radius:t.rawChartArgs.radius||0,xTranslate:12*n.domainConfigs.filter(function(u,h){return h<c}).map(function(u){return u.cols.length-s}).reduce(function(u,h){return u+h},0)},function(){return n.domainConfigs[c]}.bind(t)]});this.components=new Map(r.map(function(l,c){var u=V.apply(void 0,T(l));return[l[0]+"-"+c,u]}));var o=0;Le.forEach(function(l,c){if([1,3,5].includes(c)){var u=Y("subdomain-name",-6,o,l,{fontSize:10,dy:8,textAnchor:"end"});t.drawArea.appendChild(u)}o+=12})}},{key:"update",value:function(t){t||console.error("No data to update."),this.data=this.prepareData(t),this.draw(),this.bindTooltip()}},{key:"bindTooltip",value:function(){var t=this;this.container.addEventListener("mousemove",function(n){t.components.forEach(function(s){var r=s.store,o=n.target;if(r.includes(o)){var l=o.getAttribute("data-value"),c=o.getAttribute("data-date").split("-"),u=Ht(parseInt(c[1])-1,!0),h=t.container.getBoundingClientRect(),d=o.getBoundingClientRect(),p=parseInt(n.target.getAttribute("width")),g=d.left-h.left+p/2,f=d.top-h.top,m=l+" "+t.countLabel,y=" on "+u+" "+c[0]+", "+c[2];t.tip.setValues(g,f,{name:y,value:m,valueFirst:1},[]),t.tip.showTip()}})})}},{key:"renderLegend",value:function(){var t=this;this.legendArea.textContent="";var n=0,s=this.rawChartArgs.radius||0,r=Y("subdomain-name",n,12,"Less",{fontSize:11,dy:9});n=30,this.legendArea.appendChild(r),this.colors.slice(0,5).map(function(l,c){var u=_t("heatmap-legend-unit",n+15*c,12,10,s,l);t.legendArea.appendChild(u)});var o=Y("subdomain-name",n+75+3,12,"More",{fontSize:11,dy:9});this.legendArea.appendChild(o)}},{key:"getDomains",value:function(){for(var t=this.state,n=[t.start.getMonth(),t.start.getFullYear()],s=n[0],r=n[1],o=[t.end.getMonth(),t.end.getFullYear()],l=o[0]-s+1+12*(o[1]-r),c=[],u=S(t.start),h=0;h<l;h++){var d=t.end;if(!Te(u,t.end)){var p=[u.getMonth(),u.getFullYear()];d=Tt(p[0],p[1])}c.push(this.getDomainConfig(u,d)),z(d,1),u=d}return c}},{key:"getDomainConfig",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=[t.getMonth(),t.getFullYear()],r=s[0],o=s[1],l=Wt(t),c={index:r,cols:[]};z(n=S(n)||Tt(r,o),1);for(var u,h=nt(l,n),d=[],p=0;p<h;p++)u=this.getCol(l,r),d.push(u),z(l=new Date(u[6].yyyyMmDd),1);return u[6].dataValue!==void 0&&(z(l,1),d.push(this.getCol(l,r,!0))),c.cols=d,c}},{key:"getCol",value:function(t,n){for(var s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r=this.state,o=S(t),l=[],c=0;c<7;c++,z(o,1)){var u={},h=o>=r.start&&o<=r.end;s||o.getMonth()!==n||!h?u.yyyyMmDd=et(o):u=this.getSubDomainConfig(o),l.push(u)}return l}},{key:"getSubDomainConfig",value:function(t){var n,s,r=et(t),o=this.data.dataPoints[r];return{yyyyMmDd:r,dataValue:o||0,fill:this.colors[n=o,s=this.state.distribution,s.filter(function(l){return l<n}).length]}}}]),a}();function _e(e,i){e.labels=e.labels||[];var a=e.labels.length,t=e.datasets,n=new Array(a).fill(0);return t||(t=[{values:n}]),t.map(function(s){if(s.values){var r=s.values;r=(r=r.map(function(o){return isNaN(o)?0:o})).length>a?r.slice(0,a):st(r,a-r.length,0),s.values=r}else s.values=n;s.chartType||(s.chartType=i)}),e.yRegions&&e.yRegions.map(function(s){if(s.end<s.start){var r=[s.end,s.start];s.start=r[0],s.end=r[1]}}),e}function ze(e){var i=e.labels.length,a=new Array(i).fill(0),t={labels:e.labels.slice(0,-1),datasets:e.datasets.map(function(n){return{name:"",values:a.slice(0,-1),chartType:n.chartType}})};return e.yMarkers&&(t.yMarkers=[{value:0,label:""}]),e.yRegions&&(t.yRegions=[{start:0,end:0,label:""}]),t}var ct=function(e){R(a,ht);var i=H(a);function a(t,n){var s;return P(this,a),(s=i.call(this,t,n)).barOptions=n.barOptions||{},s.lineOptions=n.lineOptions||{},s.type=n.type||"line",s.init=1,s.setup(),s}return N(a,[{key:"setMeasures",value:function(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}},{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),t.axisOptions=t.axisOptions||{},t.tooltipOptions=t.tooltipOptions||{},this.config.xAxisMode=t.axisOptions.xAxisMode||"span",this.config.yAxisMode=t.axisOptions.yAxisMode||"span",this.config.xIsSeries=t.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=t.axisOptions.shortenYAxisNumbers||0,this.config.numberFormatter=t.axisOptions.numberFormatter,this.config.yAxisRange=t.axisOptions.yAxisRange||{},this.config.formatTooltipX=t.tooltipOptions.formatTooltipX,this.config.formatTooltipY=t.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=t.valuesOverPoints,this.config.legendRowHeight=30}},{key:"prepareData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return _e(t,this.type)}},{key:"prepareFirstData",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return ze(t)}},{key:"calc",value:function(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.calcXPositions(),t||this.calcYAxisParameters(this.getAllYValues(),this.type==="line"),this.makeDataByIndex()}},{key:"calcXPositions",value:function(){var t=this.state,n=this.data.labels;t.datasetLength=n.length,t.unitWidth=this.width/t.datasetLength,t.xOffset=t.unitWidth/2,t.xAxis={labels:n,positions:n.map(function(s,r){return St(t.xOffset+r*t.unitWidth)})}}},{key:"calcYAxisParameters",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"false",s=Ee(t,n,this.config.yAxisRange),r=this.height/Se(s),o=Bt(s)*r,l=this.height-Oe(s)*o;this.state.yAxis={labels:s,positions:s.map(function(c){return l-c*r}),scaleMultiplier:r,zeroLine:l},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}},{key:"calcDatasetPoints",value:function(){var t=this.state,n=function(s){return s.map(function(r){return U(r,t.yAxis)})};t.datasets=this.data.datasets.map(function(s,r){var o=s.values,l=s.cumulativeYs||[];return{name:s.name&&s.name.replace(/<|>|&/g,function(c){return c=="&"?"&amp;":c=="<"?"&lt;":"&gt;"}),index:r,chartType:s.chartType,values:o,yPositions:n(o),cumulativeYs:l,cumulativeYPos:n(l)}})}},{key:"calcYExtremes",value:function(){var t=this.state;this.barOptions.stacked?t.yExtremes=t.datasets[t.datasets.length-1].cumulativeYPos:(t.yExtremes=new Array(t.datasetLength).fill(9999),t.datasets.map(function(n){n.yPositions.map(function(s,r){s<t.yExtremes[r]&&(t.yExtremes[r]=s)})}))}},{key:"calcYRegions",value:function(){var t=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map(function(n){return n.position=U(n.value,t.yAxis),n.options||(n.options={}),n})),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map(function(n){return n.startPos=U(n.start,t.yAxis),n.endPos=U(n.end,t.yAxis),n.options||(n.options={}),n}))}},{key:"getAllYValues",value:function(){var t,n=this,s="values";if(this.barOptions.stacked){s="cumulativeYs";var r=new Array(this.state.datasetLength).fill(0);this.data.datasets.map(function(l,c){var u=n.data.datasets[c].values;l[s]=r=r.map(function(h,d){return h+u[d]})})}var o=this.data.datasets.map(function(l){return l[s]});return this.data.yMarkers&&o.push(this.data.yMarkers.map(function(l){return l.value})),this.data.yRegions&&this.data.yRegions.map(function(l){o.push([l.end,l.start])}),(t=[]).concat.apply(t,T(o))}},{key:"setupComponents",value:function(){var t=this,n=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers,numberFormatter:this.config.numberFormatter},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){var h=this.state;return h.xAxis.calcLabels=function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],f=d/p.length*.6;f<=0&&(f=1);var m,y=f/7;if(g){var x=Math.max.apply(Math,T(p.map(function(b){return b.length})));m=Math.ceil(x/y)}var A=p.map(function(b,C){return(b+="").length>y&&(g?C%m!=0?C!==p.length-1&&(b=""):C>p.length-m/2&&(b=""):b=y-3>0?b.slice(0,y-3)+" ...":b.slice(0,y)+".."),b});return A}(this.width,h.xAxis.labels,this.config.xIsSeries),h.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],s=this.state.datasets.filter(function(h){return h.chartType==="bar"}),r=this.state.datasets.filter(function(h){return h.chartType==="line"}),o=s.map(function(h){var d=h.index;return["barGraph-"+h.index,{index:d,color:t.colors[d],stacked:t.barOptions.stacked,valuesOverPoints:t.config.valuesOverPoints,minHeight:0*t.height},function(){var p=this.state,g=p.datasets[d],f=this.barOptions.stacked,m=this.barOptions.spaceRatio||.5,y=p.unitWidth*(1-m),x=y/(f?1:s.length),A=p.xAxis.positions.map(function(M){return M-y/2});f||(A=A.map(function(M){return M+x*d}));var b=new Array(p.datasetLength).fill("");this.config.valuesOverPoints&&(b=f&&g.index===p.datasets.length-1?g.cumulativeYs:g.values);var C=new Array(p.datasetLength).fill(0);return f&&(C=g.yPositions.map(function(M,F){return M-g.cumulativeYPos[F]})),{xPositions:A,yPositions:g.yPositions,offsets:C,labels:b,zeroLine:p.yAxis.zeroLine,barsWidth:y,barWidth:x}}.bind(t)]}),l=r.map(function(h){var d=h.index;return["lineGraph-"+h.index,{index:d,color:t.colors[d],svgDefs:t.svgDefs,heatline:t.lineOptions.heatline,regionFill:t.lineOptions.regionFill,spline:t.lineOptions.spline,showDots:t.lineOptions.showDots,trailingDot:t.lineOptions.trailingDot,hideDotBorder:t.lineOptions.hideDotBorder,hideLine:t.lineOptions.hideLine,valuesOverPoints:t.config.valuesOverPoints},function(){var p=this.state,g=p.datasets[d],f=p.yAxis.positions[0]<p.yAxis.zeroLine?p.yAxis.positions[0]:p.yAxis.zeroLine;return{xPositions:p.xAxis.positions,yPositions:g.yPositions,values:g.values,zeroLine:f,radius:this.lineOptions.dotSize||4}}.bind(t)]}),c=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]];n=n.concat(o,l,c);var u=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(n.filter(function(h){return!u.includes(h[0])||t.state[h[0]]}).map(function(h){var d=V.apply(void 0,T(h));return(h[0].includes("lineGraph")||h[0].includes("barGraph"))&&t.dataUnitComponents.push(d),[h[0],d]}))}},{key:"makeDataByIndex",value:function(){var t=this;this.dataByIndex={};var n=this.state,s=this.config.formatTooltipX,r=this.config.formatTooltipY;n.xAxis.labels.map(function(o,l){var c=t.state.datasets.map(function(u,h){var d=u.values[l];return{title:u.name,value:d,yPos:u.yPositions[l],color:t.colors[h],formatted:r?r(d):d}});t.dataByIndex[l]={label:o,formattedLabel:s?s(o):o,xPos:n.xAxis.positions[l],values:c,yExtreme:n.yExtremes[l]}})}},{key:"bindTooltip",value:function(){var t=this;this.container.addEventListener("mousemove",function(n){var s=t.measures,r=q(t.container),o=n.pageX-r.left-G(s),l=n.pageY-r.top;l<t.height+X(s)&&l>X(s)?t.mapTooltipXPosition(o):t.tip.hideTip()})}},{key:"mapTooltipXPosition",value:function(t){var n=this.state;if(n.yExtremes){var s=function(o,l){var c=arguments.length>2&&arguments[2]!==void 0&&arguments[2],u=l.reduce(function(h,d){return Math.abs(d-o)<Math.abs(h-o)?d:h},[]);return c?l.indexOf(u):u}(t,n.xAxis.positions,!0);if(s>=0){var r=this.dataByIndex[s];this.tip.setValues(r.xPos+this.tip.offset.x,r.yExtreme+this.tip.offset.y,{name:r.formattedLabel,value:""},r.values,s),this.tip.showTip()}}}},{key:"renderLegend",value:function(){var t=this.data;t.datasets.length>1&&L(w(a.prototype),"renderLegend",this).call(this,t.datasets)}},{key:"makeLegend",value:function(t,n,s,r){return zt(s,r+5,12,3,this.colors[n],t.name,null,8.75,this.config.truncateLegends)}},{key:"makeOverlay",value:function(){var t=this;this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach(function(n){var s=n.overlay;s.parentNode.removeChild(s)}),this.overlayGuides=this.dataUnitComponents.map(function(n){return{type:n.unitType,overlay:void 0,units:n.units}}),this.state.currentIndex===void 0&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map(function(n){var s=n.units[t.state.currentIndex];n.overlay=ye[n.type](s),t.drawArea.appendChild(n.overlay)}))}},{key:"updateOverlayGuides",value:function(){this.overlayGuides&&this.overlayGuides.forEach(function(t){var n=t.overlay;n.parentNode.removeChild(n)})}},{key:"bindOverlay",value:function(){var t=this;this.parent.addEventListener("data-select",function(){t.updateOverlay()})}},{key:"bindUnits",value:function(){var t=this;this.dataUnitComponents.map(function(n){n.units.map(function(s){s.addEventListener("click",function(){var r=s.getAttribute("data-point-index");t.setCurrentDataPoint(r)})})}),this.tip.container.addEventListener("click",function(){var n=t.tip.container.getAttribute("data-point-index");t.setCurrentDataPoint(n)})}},{key:"updateOverlay",value:function(){var t=this;this.overlayGuides.map(function(n){var s=n.units[t.state.currentIndex];be[n.type](s,n.overlay)})}},{key:"onLeftArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex-1)}},{key:"onRightArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex+1)}},{key:"getDataPoint",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.currentIndex,n=this.state,s={index:t,label:n.xAxis.labels[t],values:n.datasets.map(function(r){return r.values[t]})};return s}},{key:"setCurrentDataPoint",value:function(t){var n=this.state;(t=parseInt(t))<0&&(t=0),t>=n.xAxis.labels.length&&(t=n.xAxis.labels.length-1),t!==n.currentIndex&&(n.currentIndex=t,function(s,r,o){var l=document.createEvent("HTMLEvents");for(var c in l.initEvent(r,!0,!0),o)l[c]=o[c];s.dispatchEvent(l)}(this.parent,"data-select",this.getDataPoint()))}},{key:"addDataPoint",value:function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.state.datasetLength;L(w(a.prototype),"addDataPoint",this).call(this,t,n,s),this.data.labels.splice(s,0,t),this.data.datasets.map(function(r,o){r.values.splice(s,0,n[o])}),this.update(this.data)}},{key:"removeDataPoint",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.datasetLength-1;this.data.labels.length<=1||(L(w(a.prototype),"removeDataPoint",this).call(this,t),this.data.labels.splice(t,1),this.data.datasets.map(function(n){n.values.splice(t,1)}),this.update(this.data))}},{key:"updateDataset",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.data.datasets[n].values=t,this.update(this.data)}},{key:"updateDatasets",value:function(t){this.data.datasets.map(function(n,s){t[s]&&(n.values=t[s])}),this.update(this.data)}}]),a}(),Nt={bar:ct,line:ct,percentage:Me,heatmap:Fe,pie:Mt,donut:function(e){R(a,Mt);var i=H(a);function a(t,n){return P(this,a),i.call(this,t,n)}return N(a,[{key:"configure",value:function(t){L(w(a.prototype),"configure",this).call(this,t),this.type="donut",this.sliceName="donutSlices",this.arcFunc=pe,this.shapeFunc=fe,this.strokeWidth=t.strokeWidth||30}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2}},{key:"resetHover",value:function(t,n){lt(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.stroke=n}},{key:"setupComponents",value:function(){var t=this.state,n=[[this.sliceName,{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(n.map(function(s){var r=V.apply(void 0,T(s));return[s[0],r]}))}}]),a}()},It=function e(i,a){return P(this,e),function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"line",n=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;return t==="axis-mixed"?(s.type="line",new ct(n,s)):Nt[t]?new Nt[t](n,s):void console.error("Undefined chart type: "+t)}(a.type,i,a)};frappe.provide("frappe.ui");frappe.Chart=It;frappe.ui.RealtimeChart=class extends frappe.Chart{constructor(i,a,t=8,n){super(i,n);n.data.datasets[0].values.length>t&&frappe.throw(__("Length of passed data array is greater than value of maximum allowed label points!")),this.currentSize=n.data.datasets[0].values.length,this.socketEvent=a,this.maxLabelPoints=t,this.start_updating=function(){frappe.realtime.on(this.socketEvent,s=>{this.update_chart(s.label,s.points)})},this.stop_updating=function(){frappe.realtime.off(this.socketEvent)},this.update_chart=function(s,r){this.currentSize>=this.maxLabelPoints?this.removeDataPoint(0):this.currentSize++,this.addDataPoint(s,r)}}};})();
//# sourceMappingURL=website.bundle.Y7QD6ICR.js.map
